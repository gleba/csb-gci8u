{"version":3,"sources":["heartdonation/css.js","heartdonation/svg.heart.js","heartdonation/widget.js","heartdonation/index.js"],"names":["css","styles","styleSheet","document","createElement","type","innerText","head","appendChild","heartPath","child","animAlpha","from","to","dur","animScale","animMove","f","x","aHeart","Ah","t","svgHeart","getUrl","name","end_date","start_date","moneyFormater","Intl","NumberFormat","style","currency","declOfNum","number","titles","getDayLabel","value","Math","round","makeWidget","tag","props","getAttribute","dataUrl","targetValue","diffDays","Date","getTime","innerHTML","format","el","children","targetDiv","currentValueDiv","donateButton","si","setInterval","random","opacity","setTargetAlpha","color","fetch","then","r","json","resp","console","log","clearInterval","data","catch","e","addEventListener","window","open","myInitCode","widgets","getElementsByClassName","element","readyState"],"mappings":"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","file":"heartdonation.6d708aa5.js","sourceRoot":"..","sourcesContent":["const css = (styles) => {\n  var styleSheet = document.createElement(\"style\");\n  styleSheet.type = \"text/css\";\n  styleSheet.innerText = styles;\n  document.head.appendChild(styleSheet);\n};\n\ncss`\n  .heart-donation {\n    max-width: 600px;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    font-family: sans-serif;\n  }\n\n  .heart-donation .metric {\n    width: 100%;\n    height: 12px;\n    position: relative;\n    pointer-events: none;\n  }\n\n  .heart-donation .target {\n    position: absolute;\n    right: 0;\n    top: -200px;\n    text-align: right;\n    font-weight: bolder;\n    color: #0000ff;\n\n    -webkit-animation: slide-in-right 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)\n      both;\n    animation: slide-in-right 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;\n  }\n  .heart-donation .value {\n    font-size: 32px;\n  }\n  .heart-donation .target .value {\n    color: #000077;\n  }\n\n  .heart-donation .current {\n    position: absolute;\n    left: 0;\n    top: -48px;\n    text-align: left;\n    font-weight: bolder;\n    color: #0770077;\n\n    -webkit-animation: slide-in-left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)\n      both;\n    animation: slide-in-left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;\n  }\n\n  .heart-donation .current .value {\n    color: #00aa0055;\n  }\n  .heart-donation .name {\n    margin-top: -28px;\n    padding-bottom: 10px;\n    color: #ffaaaa;\n  }\n  .heart-donation button {\n    cursor: pointer;\n    padding: 13px;\n    font-weight: 800;\n    border: none;\n    /* box-shadow: 0px 0px 50px 1px #00000033 !important; */\n    -webkit-animation: shadow-drop-2-center 0.4s\n      cubic-bezier(0.25, 0.46, 0.45, 0.94) both;\n    animation: shadow-drop-2-center 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)\n      both;\n    transition: all 1s;\n  }\n\n  .heart-donation button:hover {\n    color: red;\n    box-shadow: 0px 0px 5px 1px #00000033 !important;\n    animation: none;\n  }\n  /* ----------------------------------------------\n * Generated by Animista on 2021-12-9 15:53:21\n * Licensed under FreeBSD License.\n * See http://animista.net/license for more info. \n * w: http://animista.net, t: @cssanimista\n * ---------------------------------------------- */\n\n  /**\n * ----------------------------------------\n * animation shadow-drop-2-center\n * ----------------------------------------\n */\n  @-webkit-keyframes shadow-drop-2-center {\n    0% {\n      -webkit-transform: translateZ(0);\n      transform: translateZ(0);\n      -webkit-box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\n      box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\n    }\n    100% {\n      -webkit-transform: translateZ(50px);\n      transform: translateZ(50px);\n      -webkit-box-shadow: 0 0 20px 0px rgba(0, 0, 0, 0.25);\n      box-shadow: 0 0 20px 0px rgba(0, 0, 0, 0.25);\n    }\n  }\n  @keyframes shadow-drop-2-center {\n    0% {\n      -webkit-transform: translateZ(0);\n      transform: translateZ(0);\n      -webkit-box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\n      box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);\n    }\n    100% {\n      -webkit-transform: translateZ(50px);\n      transform: translateZ(50px);\n      -webkit-box-shadow: 0 0 20px 0px rgba(0, 0, 0, 0.25);\n      box-shadow: 0 0 20px 0px rgba(0, 0, 0, 0.25);\n    }\n  }\n\n  /* ----------------------------------------------\n * Generated by Animista on 2021-12-9 16:3:53\n * Licensed under FreeBSD License.\n * See http://animista.net/license for more info. \n * w: http://animista.net, t: @cssanimista\n * ---------------------------------------------- */\n\n  /**\n * ----------------------------------------\n * animation slide-in-right\n * ----------------------------------------\n */\n  @-webkit-keyframes slide-in-right {\n    0% {\n      -webkit-transform: translateX(1000px);\n      transform: translateX(1000px);\n      opacity: 0;\n    }\n    100% {\n      -webkit-transform: translateX(0);\n      transform: translateX(0);\n      opacity: 1;\n    }\n  }\n  @keyframes slide-in-right {\n    0% {\n      -webkit-transform: translateX(1000px);\n      transform: translateX(1000px);\n      opacity: 0;\n    }\n    100% {\n      -webkit-transform: translateX(0);\n      transform: translateX(0);\n      opacity: 1;\n    }\n  }\n\n  /* ----------------------------------------------\n * Generated by Animista on 2021-12-9 16:5:42\n * Licensed under FreeBSD License.\n * See http://animista.net/license for more info. \n * w: http://animista.net, t: @cssanimista\n * ---------------------------------------------- */\n\n  /**\n * ----------------------------------------\n * animation slide-in-left\n * ----------------------------------------\n */\n  @-webkit-keyframes slide-in-left {\n    0% {\n      -webkit-transform: translateX(-1000px);\n      transform: translateX(-1000px);\n      opacity: 0;\n    }\n    100% {\n      -webkit-transform: translateX(0);\n      transform: translateX(0);\n      opacity: 1;\n    }\n  }\n  @keyframes slide-in-left {\n    0% {\n      -webkit-transform: translateX(-1000px);\n      transform: translateX(-1000px);\n      opacity: 0;\n    }\n    100% {\n      -webkit-transform: translateX(0);\n      transform: translateX(0);\n      opacity: 1;\n    }\n  }\n`;\n","const heartPath = (child) => `<path fill=\"#FF0000\" stroke=\"none\" d=\"\nM 299.05 89.4\nQ 304.15 60.75 281.7 31.55 218 -31.55 150 31.55 81.95 -31.55 18.3 31.55 -4.15 60.75 0.95 89.4 5.25 113.1 31.05 144.55 40.45 156 57.4 174.2 77.2 195.25 87.7 206.75 126.8 249.5 150 285.6\nL 150 285.65 150.05 285.6\nQ 173.2 249.5 212.3 206.75 222.75 195.25 242.6 174.2 259.5 156 268.95 144.55 294.75 113.1 299.05 89.4 Z\">\n${child}\n</path>`;\n\nconst animAlpha = (from, to, dur) => `\n<animate attributeName=\"fill-opacity\"\ndur=\"${dur}s\"\nvalues=\"${to - 0.3};${from - 0.3};\"\nrepeatCount=\"indefinite\"\n/>\n`;\nconst animScale = (from, to, dur) => `\n\n<animateTransform attributeName=\"transform\"\nattributeType=\"XML\"\ntype=\"scale\"\nfrom=\"${from} ${from}\"\nto=\"${to} ${to}\"\ndur=\"${dur}s\"\nrepeatCount=\"indefinite\"/>\n`;\n\nconst animMove = (from, to, dur) => {\n  const f = (x) => 150 - 150 * x;\n  return `\n<animateTransform attributeName=\"transform\"\nattributeType=\"XML\"\ntype=\"translate\"\nfrom=\"${f(from)} ${f(from)}\"\nto=\"${f(to)} ${f(to)}\"\ndur=\"${dur}s\"\nrepeatCount=\"indefinite\"/>`;\n};\n\nconst aHeart = (...arg) => `\n<g>\n  ${animMove(...arg)}\n  <g>\n    ${animScale(...arg)}\n    ${heartPath(animAlpha(...arg))}\n  </g>\n</g>`;\nconst Ah = (t) => aHeart(1, 0.3, t) + aHeart(0.3, 1, t);\nexport const svgHeart = `<svg width=\"200\" height=\"200\" viewBox=\"0 0 300 300\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"#fff\">\n${Ah(3)}\n${Ah(5)}\n${Ah(8)}\n${Ah(13)}\n</svg>`;\n","import { svgHeart } from \"./svg.heart\";\n\nconst getUrl = ({ name, end_date, start_date }) =>\n  `https://gps.raevskyteam.org/donation?name=${name}&end_date=${end_date}&start_date=${start_date}`;\n\nconst moneyFormater = new Intl.NumberFormat(\"ru-RU\", {\n  style: \"currency\",\n  currency: \"RUB\"\n});\n\nconst declOfNum = function (number, titles) {\n  var cases = [2, 0, 1, 1, 1, 2];\n  return titles[\n    number % 100 > 4 && number % 100 < 20\n      ? 2\n      : cases[number % 10 < 5 ? number % 10 : 5]\n  ];\n};\n\nfunction getDayLabel(value) {\n  value = Math.round(value);\n  return value + \" \" + declOfNum(value, [\"день\", \"дня\", \"дней\"]);\n}\nexport function makeWidget(tag) {\n  const props = {\n    name: tag.getAttribute(\"data-name\"),\n    start_date: tag.getAttribute(\"data-start\"),\n    end_date: tag.getAttribute(\"data-end\")\n  };\n  const dataUrl = tag.getAttribute(\"data-url\");\n  const targetValue = tag.getAttribute(\"data-target\");\n  const diffTime = new Date(props.end_date).getTime() - new Date().getTime();\n  const diffDays = diffTime / (1000 * 3600 * 24);\n\n  tag.innerHTML = `\n  <div class=\"heart-donation\">\n    ${svgHeart}\n    <div class=\"metric\">\n      <div class=\"target\" id=\"donate-target\" >Необходимо \n        <div class=\"value\">\n        ${moneyFormater.format(targetValue)}\n        </div>\n        <div>\n           ${diffDays > 0 ? \"осталось \" + getDayLabel(diffDays) : \"Завершено\"} \n        </div>\n      </div>\n      <div class=\"current\" id=\"donate-target\" ><div class=\"value\">3497</div> Собрано </div>\n    </div>\n    <div class=\"name\"> ${props.name} </div>\n    <button id=\"heart-donate-button\">Пожертвовать любую сумму</button>\n  </div>\n  `;\n\n  const el = tag.children[0];\n  const targetDiv = el.children[1].children[0];\n  const currentDiv = el.children[1].children[1];\n  const currentValueDiv = currentDiv.children[0];\n  const donateButton = el.children[3];\n  const si = setInterval(() => {\n    currentValueDiv.innerHTML = Math.round(1000000 * Math.random());\n  }, 60);\n  currentValueDiv.style.opacity = \"0.2\";\n\n  const setTargetAlpha = () => {\n    targetDiv.style.color = \"#0000FF33\";\n    targetDiv.children[0].style.opacity = \"0.1\";\n  };\n  setTargetAlpha();\n  fetch(getUrl(props))\n    .then((r) => {\n      r.json().then((resp) => {\n        console.log(resp);\n        clearInterval(si);\n        currentValueDiv.innerHTML = moneyFormater.format(resp.data);\n        currentValueDiv.style.opacity = \"0.7\";\n      });\n    })\n    .catch((e) => {\n      clearInterval(si);\n      console.log(\"error\", e);\n    });\n\n  donateButton.addEventListener(\"mouseout\", (e) => {\n    window.open(dataUrl, \"_blank\");\n  });\n\n  donateButton.addEventListener(\"mouseover\", (e) => {\n    targetDiv.style.color = \"#0000FF55\";\n    targetDiv.children[0].style.opacity = \"0.7\";\n    console.log(targetDiv);\n  });\n\n  donateButton.addEventListener(\"mouseout\", setTargetAlpha);\n}\n","import \"./css\";\nimport { makeWidget } from \"./widget\";\n\nif (document.readyState !== \"loading\") {\n  myInitCode();\n} else {\n  document.addEventListener(\"DOMContentLoaded\", myInitCode);\n}\n\nfunction myInitCode() {\n  const widgets = document.getElementsByClassName(\"heart-donor\");\n  for (let element of widgets) {\n    makeWidget(element);\n  }\n}\n"]}